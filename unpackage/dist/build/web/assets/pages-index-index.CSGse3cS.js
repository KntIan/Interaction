import{r as a,u as s,v as e,x as l,o as t,c as o,a as n,i as c,b as i,d as u,e as r,y as d,z as m,F as p,A as g,t as v,B as _,n as f,q as h,l as x,m as y,p as b}from"./index-B-dpguDl.js";import{_ as k}from"./Frame.DjTFjFmC.js";import{u as w,_ as j}from"./store.C53TceNa.js";import{o as L}from"./uni-app.es.D1-l22Qc.js";import{_ as C,g as F,p as T,a as z,c as H,b as M}from"./_plugin-vue_export-helper.q9aTn_51.js";const q=C({__name:"index",setup(C){const q=w(),A=a(!1),B=a({}),I=a(!1),N=a(""),O=a([]),S=a([]),D=s((()=>q.logs.map((a=>({value:String(a.id),label:a.title,image:a.thumb}))))),E=()=>{S.value=q.logs.map((()=>"/static/images/iconno.png"))},G=(a,s)=>{N.value=a,(a=>{const s=Number(a),e=O.value.indexOf(s);e>-1?O.value.splice(e,1):O.value.push(s),N.value=s})(a),(a=>{S.value[a]="/static/images/iconno.png"===S.value[a]?"/static/images/iconis.png":"/static/images/iconno.png"})(s)},J=async()=>{try{const a=F("param")||e("param"),s=O.value.join(","),l=await M({param:a,ids:s});1===l.code?(h({title:l.msg,icon:"none",duration:2e3}),I.value=!1,E()):console.error("提交失败:",l.message||"未知错误")}catch(a){console.error("提交发生错误:",a.message||"未知错误")}};return L((async()=>{const a=e("param")||F("param");if(console.log(a),a)try{l("param",a);const s=await T({param:a});A.value=s.data.is_point,B.value=s.data.product,s.data.is_all&&!s.data.is_like&&(I.value=!0),q.setLogs([...q.logs,{is_point:A.value,product:B.value}]);const e=await z({param:a});q.setLogs(e.data||[]),E()}catch(s){console.error("操作失败:",s.message||"未知错误")}else console.warn("没有有效的参数")})),t((()=>{H()})),(a,s)=>{const e=c,l=x,t=y,h=b;return i(),o(e,{class:"container"},{default:n((()=>[I.value?(i(),o(e,{key:0,class:"custom-toast"},{default:n((()=>[u(e,{class:"overlay"}),u(e,{class:"toast-content"},{default:n((()=>[u(e,{class:"logo_tit"},{default:n((()=>[u(l,{src:k,style:{width:"145px",height:"20px"}}),u(t,{style:{"font-size":"14px",color:"#000000"}},{default:n((()=>[r("请选择感兴趣的产品")])),_:1})])),_:1}),u(e,{class:"logs_box"},{default:n((()=>[(i(!0),d(p,null,m(D.value,((a,s)=>(i(),o(e,{class:"item",key:a.value},{default:n((()=>[u(l,{class:"log-image",src:a.image},null,8,["src"]),u(e,{class:"product-name"},{default:n((()=>[r(v(a.label),1)])),_:2},1024),u(e,{style:{"text-align":"center",margin:"auto"},onClick:e=>G(a.value,s)},{default:n((()=>[u(l,{style:{width:"24px",height:"24px"},src:S.value[s],mode:"scaleToFill"},null,8,["src"])])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1}),u(e,{class:"footer"},{default:n((()=>[u(h,{onClick:J},{default:n((()=>[r("提交")])),_:1})])),_:1})])),_:1})])),_:1})):g("",!0),u(e,{class:"info_img"},{default:n((()=>[u(l,{style:{width:"100%",height:"100%"},src:B.value.thumb},null,8,["src"])])),_:1}),u(e,{class:"info_text"},{default:n((()=>[u(t,null,{default:n((()=>[r(v(B.value.title),1)])),_:1}),_("div",{class:"content",innerHTML:B.value.content},null,8,["innerHTML"]),u(e,{class:f(["status",{"checked-in":A.value,"not-checked-in":!A.value}])},{default:n((()=>[A.value?(i(),o(l,{key:0,style:{width:"16px",height:"16px"},src:j})):g("",!0),u(t,null,{default:n((()=>[r(v(A.value?"已打卡":"未打卡"),1)])),_:1})])),_:1},8,["class"])])),_:1})])),_:1})}}},[["__scopeId","data-v-45013bc7"]]);export{q as default};
