import{r as a,u as l,o as e,c as s,a as t,A as u,i as c,b as o,d as n,e as d,t as i,K as r,y as f,z as _,F as m,q as y,l as v,L as p,m as h,f as k}from"./index-B-dpguDl.js";import{_ as g}from"./Frame.DjTFjFmC.js";import{_ as b,f as x,h as w,i as C}from"./_plugin-vue_export-helper.q9aTn_51.js";const j=b({__name:"my",setup(b){const j=a(null),F=a([]),z=a(!1),q=l((()=>F.value.length>1?2:1)),A=()=>{0===F.value.length?y({title:"没有可领取的奖品",icon:"none",duration:2e3}):I()},I=()=>{z.value=!0},K=()=>{z.value=!1};return e((()=>{(async()=>{try{const a=await x();j.value=a.data}catch(a){console.error("打卡失败:",a)}})(),(async()=>{try{const a=await w();F.value=a.data||[]}catch(a){console.error("获取奖品记录失败:",a)}})()})),(a,l)=>{const e=c,b=v,x=p,w=h;return j.value?(o(),s(e,{key:0,class:"my_box"},{default:t((()=>[n(e,{class:"title"},{default:t((()=>[d("我的")])),_:1}),n(e,{class:"card"},{default:t((()=>[n(b,{class:"logo",style:{width:"87px",height:"12px"},src:g,mode:"scaleToFill"}),n(e,{class:"user-info"},{default:t((()=>[n(e,{class:"name"},{default:t((()=>[d(i(j.value.nickname),1)])),_:1}),n(e,{class:"phone"},{default:t((()=>[d(i(j.value.mobile),1)])),_:1})])),_:1})])),_:1}),n(e,{class:"info"},{default:t((()=>[n(e,{class:"item"},{default:t((()=>[n(x,null,{default:t((()=>[d("公司")])),_:1}),n(w,null,{default:t((()=>[d(i(j.value.company),1)])),_:1})])),_:1}),n(e,{class:"item"},{default:t((()=>[n(x,null,{default:t((()=>[d("职位")])),_:1}),n(w,null,{default:t((()=>[d(i(j.value.position),1)])),_:1})])),_:1}),n(e,{class:"item"},{default:t((()=>[n(x,null,{default:t((()=>[d("地址")])),_:1}),n(w,null,{default:t((()=>[d(i(j.value.address),1)])),_:1})])),_:1})])),_:1}),n(e,{class:"info prize",onClick:A},{default:t((()=>[n(e,{style:{display:"flex","justify-content":"space-between"},class:"item"},{default:t((()=>[n(x,null,{default:t((()=>[d("领奖记录")])),_:1}),n(w,{style:{color:"#808080"}},{default:t((()=>[d(">")])),_:1})])),_:1})])),_:1}),z.value?(o(),s(e,{key:0,class:"modal-mask",onClick:K})):u("",!0),z.value?(o(),s(e,{key:1,class:"modal"},{default:t((()=>[n(e,{class:"close-btn",onClick:K},{default:t((()=>[d("✖")])),_:1}),n(e,{class:"modal-content"},{default:t((()=>[n(e,{class:"modal-body",style:r({columnCount:q.value})},{default:t((()=>[(o(!0),f(m,null,_(F.value,(a=>(o(),s(e,{class:"item_",key:a.id},{default:t((()=>[n(b,{class:"log-image",src:a.award_thumb},null,8,["src"]),n(e,{style:{padding:"10px 0"},class:"product-name"},{default:t((()=>[d(i(a.activity_title),1)])),_:2},1024),n(w,{class:"footer",onClick:k((l=>(async a=>{try{await C({id:String(a)}),F.value=F.value.filter((l=>l.id!==a)),y({title:"删除记录成功",icon:"success",duration:2e3}),0===F.value.length&&K()}catch(l){console.error("删除记录失败:",l),y({title:"删除记录失败",icon:"error",duration:2e3})}})(a.id)),["stop"])},{default:t((()=>[d("删除")])),_:2},1032,["onClick"])])),_:2},1024)))),128))])),_:1},8,["style"])])),_:1})])),_:1})):u("",!0)])),_:1})):u("",!0)}}},[["__scopeId","data-v-8ebc02fd"]]);export{j as default};
